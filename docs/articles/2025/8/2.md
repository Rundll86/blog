# 【避坑】取模与求余

在大多数编程语言中，`%`这个运算符表示取模。  
但是实际上，还有一种运算叫求余。

- 取模：`a - (b * floor(a / b))`
- 求余：`a - (b * trunc(a / b))`
  - `trunc`表示向零取整，即取该数与0之间最靠近该数的整数。
  - `floor`表示向下取整，即取不大于该数的最大整数。

在`Python、C#`等语言中，`%`运算符表示取模。  
在`JavaScript`中，`%`运算符表示求余。

当时我做一个前端轮播图组件，打算是根据余数来求当前轮播图的索引。由于js的求余运算，余数与除数符号相同，所以靠传入一个一维向量（ `-1` | `0` | `1` ）来使用`%`是会导致出现负数索引的。

例如：  
轮播图一共有5张，当前在`索引0`，而用户点击了`向右滚动`，索引应该**减1**，变为负数后通过取模自动转换为`索引4`，那么

```js
newIndex = (oldIndex + vector) % carouselCount
```

看起来天衣无缝，`(0-1)%5=4`，对吧。  
但因为js的神秘求余运算，`(0-1)%5`实际上为`-1`。排查这个问题搞了半天才找出来。  
解决方法是写一个`mod`函数手动取模：

```ts
function mod(n: number, m: number): number {
  return ((n % m) + m) % m;
}
```

## The end
